var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,o=(e,t)=>{for(var n in t||(t={}))l.call(t,n)&&r(e,n,t[n]);if(a)for(var n of a(t))i.call(t,n)&&r(e,n,t[n]);return e},s=(e,a)=>t(e,n(a));import{R as c,C as m,D as u,a as p,M as d,b as g,c as h,S as f,I as E,d as y,e as v,T as C,f as k,g as x,h as b,B as w,i as S,j as P}from"./vendor.2b3219c2.js";var O,A;function j(e){return e&&"string"==typeof e?e.startsWith("minecraft:")?e.slice(10):e:"error"}function _(e){return"minecraft:"+e}(A=O||(O={}))[A.CraftShaped=0]="CraftShaped",A[A.CraftShapeless=1]="CraftShapeless",A[A.StoneCutting=2]="StoneCutting",A[A.Smithing=3]="Smithing",A[A.Other=4]="Other";const N={crafting_shaped:{name:"有序合成",type:0},crafting_shapeless:{name:"无序合成",type:1},stonecutting:{name:"切石机",type:2},smithing:{name:"锻造台",type:3},blasting:{name:"高炉",type:4},campfire_cooking:{name:"营火",type:4},smelting:{name:"熔炉",type:4},smoking:{name:"烟熏炉",type:4}};function B(e){return"crafting_shapeless"===e?1:"crafting_shaped"===e?0:"stonecutting"===e?2:"smithing"===e?3:4}var R,H=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},I=(e,t,n)=>(H(e,t,"read from private field"),n?n.call(e):t.get(e));function M(e){return{item:(Array.isArray(e)?e:[e]).map(j)}}function $(e){return M(function(e){return(Array.isArray(e)?e:[e]).map((e=>_(j(e.item))))}(e))}const D=class{constructor(){((e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)})(this,R,D.getDefaultValue())}static convertByPattern(e){return e.pattern.join("").split("").reduce(((t,n)=>" "===n?(t.push(void 0),t):(t.push($(e.key[n])),t)),[])}static getDefaultValue(){return{type:"crafting_shaped",ingredients:[],result:void 0,group:""}}static getKeyPattern(e){const t={},n={};let a=0;const l=[];let i="";for(Array.from({length:9},(()=>"")).forEach(((r,o)=>{const s=e[o];if(s){const e=s.item.join("-"),l=t[e];let r="";void 0===l?(t[e]=a,r=D.Keys[a++],n[r]=s.item.length>1?s.item.map((e=>({item:_(e)}))):{item:_(s.item[0])}):r=D.Keys[l],i+=r}else i+=" ";o%3==2&&(l.push(i),i="")}));l.length;){if(l[l.length-1].trim())break;l.pop()}return{key:n,pattern:l}}get data(){const e=I(this,R),{ingredients:t,result:n}=e,r=((e,t)=>{var n={};for(var r in e)l.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&a)for(var r of a(e))t.indexOf(r)<0&&i.call(e,r)&&(n[r]=e[r]);return n})(e,["ingredients","result"]);return s(o({},r),{input:t.map((e=>({id:e.item}))),output:n?{id:n.item?[n.item]:[],count:n.count}:{}})}reset(){var e,t,n,a;e=this,t=R,n=D.getDefaultValue(),H(e,t,"write to private field"),a?a.call(e,n):t.set(e,n)}import(e){this.reset();const{group:t,experience:n,cookingtime:a}=e,l=j(e.type);let i,r,o;i="crafting_shaped"===l?D.convertByPattern(e):"crafting_shapeless"===l?e.ingredients.map((e=>$(e))):"smithing"===l?[M(e.base.item),M(e.addition.item)]:[$(e.ingredient)],"string"==typeof e.result?(r=j(e.result),o=e.count||1):(r=j(e.result.item),o=e.result.count),this.setProps({type:l,group:t,experience:n,cookingtime:a,ingredients:i,result:{item:r,count:o}})}getProps(e){return I(this,R)[e]}setProps(e){Object.keys(e).forEach((t=>{I(this,R)[t]=e[t]}))}toJson(){const{ingredients:e,result:t,cookingtime:n,experience:a,group:l}=I(this,R),i=B(I(this,R).type),r=_(I(this,R).type);if(i===O.CraftShaped){const{pattern:n,key:a}=D.getKeyPattern(e),i={type:r,key:a,pattern:n,result:t};return l?s(o({},i),{group:l}):i}if(i===O.CraftShapeless){const n={type:r,result:t,ingredients:e.map((e=>e.item.map((e=>({item:e})))))};return l?s(o({},n),{group:l}):n}if(i===O.StoneCutting){const n={type:r,count:t.count,result:t.item,ingredient:e.map((e=>({item:e.item[0]})))};return l?s(o({},n),{group:l}):n}if(i===O.Smithing){const[n,a]=e.map((e=>({item:e.item[0]}))),i={type:r,base:n,addition:a,result:{item:null==t?void 0:t.item,count:null==t?void 0:t.count}};return l?s(o({},i),{group:l}):i}const c={type:r,cookingtime:n,experience:a,result:null==t?void 0:t.item,ingredient:e.map((e=>({item:e.item[0]})))};return l?s(o({},c),{group:l}):c}};let K=D;R=new WeakMap,K.Keys=["#","$","*","%","&","|","!","+","-"];function T(e){var t,n,a,l;const i=c.useMemo((()=>{var t,n;return(null==(n=null==(t=null==e?void 0:e.data)?void 0:t.id)?void 0:n.length)?e.data.id:[]}),[e.data]);const r=c.useMemo((()=>i.length?(e.offset+1)%i.length:0),[e.offset]);return c.createElement("div",{className:"tile",onClick:null==(t=null==e?void 0:e.onClick)?void 0:t.bind(null,e.data)},c.createElement("i",{title:i[r],style:{display:"inline-block"},className:`icon-${i[r]}`},e.showCount&&(null==(n=e.data)?void 0:n.count)?c.createElement("span",null,e.data.count):null,(null==(l=null==(a=e.data)?void 0:a.id)?void 0:l.length)?c.createElement(m,{onClick:function(t){t.stopPropagation(),null==e||e.onClear(e.data)},className:"close"}):null))}function J(e){return c.createElement("div",{className:"grid",style:{width:42*e.cols}},Array.from({length:e.cols*e.rows}).map(((t,n)=>{const a=e.data[n];return c.createElement(T,{key:n,data:a,offset:e.offset,onClear:e.onClear&&e.onClear.bind(null,a,n),onClick:e.onClick&&e.onClick.bind(null,a,n)})})))}function L(e){return c.createElement("div",{className:"smithing"},c.createElement(T,{offset:e.offset,data:e.data[0],onClick:e.onClick&&e.onClick.bind(null,e.data[0],0)}),c.createElement("div",{className:"smithing-add"}),c.createElement(T,{offset:e.offset,data:e.data[1],onClick:e.onClick&&e.onClick.bind(null,e.data[1],1)}))}function V(e){const[t,n]=u.exports.useState(0);return u.exports.useEffect((()=>{let e;return e=window.setInterval((()=>{n((e=>e+1))}),1e3),()=>clearInterval(e)}),[]),c.createElement("div",{className:"craft"},c.createElement("div",{className:"input"},"crafting_shaped"===e.data.type||"crafting_shapeless"===e.data.type?c.createElement(J,{rows:3,cols:3,offset:t,data:e.data.input,onClick:e.onClick,onClear:e.onClear}):"smithing"===e.data.type?c.createElement(L,{offset:t,data:e.data.input,onClear:e.onClear,onClick:e.onClick}):c.createElement(T,{offset:t,data:e.data.input[0],onClear:e.onClear&&e.onClear.bind(null,e.data.input[0],0),onClick:e.onClick&&e.onClick.bind(null,e.data.input[0],0)})),c.createElement("div",{className:"arrow"}),c.createElement("div",{className:"output"},c.createElement(T,{data:e.data.output,showCount:e.showCount,offset:t,onClear:e.onClear&&e.onClear.bind(null,e.data.output,void 0),onClick:e.onClick&&e.onClick.bind(null,e.data.output,void 0)})))}function F(e){const[t,n]=u.exports.useState(1),[a,l]=u.exports.useState([]),[i,r]=u.exports.useState([]);function o(e){l((t=>{const[n]=e.id,a=[...t];return a.splice(t.findIndex((e=>e===n)),1),a}))}return u.exports.useEffect((()=>{p.get("./assets/map.json").then((e=>{const t=Object.entries(e).map((([e,t])=>({id:e,name:t})));r((()=>t))}))}),[]),u.exports.useEffect((()=>{l((()=>{var t;return(null==(t=e.value)?void 0:t.id)||[]})),n((()=>{var t;return(null==(t=e.value)?void 0:t.count)||1}))}),[e.visible]),c.createElement(d,{className:"item-modal",okText:"确定",cancelText:"取消",title:"物品选择框",maskClosable:!1,width:690,onOk:function(){null==e||e.onOk({id:a,count:t}),null==e||e.onCancel()},onCancel:e.onCancel,visible:e.visible},c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:20,lineHeight:"30px"}},"物品"),c.createElement(h,{span:17},c.createElement(f,{showSearch:!0,allowClear:!0,mode:"multiple",value:a,tagRender:function(e){return c.createElement(T,{offset:0,onClear:o,data:{id:[e.value]}})},onChange:function(t){t.length>e.limit?y.warning(`仅能选择 ${e.limit} 项`):l((()=>t))},style:{width:"100%"},filterOption:(e,{name:t,value:n})=>(n+t).includes(e),notFoundContent:"暂无内容",placeholder:"请选择，可搜索"},i.map((({id:e,name:t})=>c.createElement(f.Option,{key:e,value:e,name:t},t," - ",e)))))),e.showCount?c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:20,lineHeight:"30px"}},"数量"),c.createElement(h,{span:17},c.createElement(E,{step:1,max:64,min:1,style:{width:"100%"},value:t,onChange:e=>n((()=>e))}))):null)}const W={type:"crafting_shaped",input:[],output:{}};let z=new K;let Z={},U={};function q(){const[e,t]=u.exports.useState(!0),[n,a]=u.exports.useState(!1),[l,i]=u.exports.useState(W),[r,o]=u.exports.useState(0),[s,m]=u.exports.useState(""),[d,P]=u.exports.useState(""),[A,j]=u.exports.useState(),[_,R]=u.exports.useState(-1);function H(){i((()=>z.data)),j((()=>{})),o((()=>0))}u.exports.useEffect((()=>{"1.0.1"!==localStorage.getItem("version")&&(v.open({duration:0,message:c.createElement("div",null,c.createElement("h3",null,"1.0.1","-beta版本"),c.createElement("div",null,"支持常见8种类型配方的定义"),c.createElement("div",null,"支持展示数组类型的配方"),c.createElement("div",null,"支持下载文件与复制到剪贴板"),c.createElement("div",null,"支持部分经验值和烧制时间默认值填充"),c.createElement("div",{style:{textAlign:"right"}},"感谢您的支持 by hans000"))}),localStorage.setItem("version","1.0.1"))}),[]),u.exports.useEffect((()=>{p.get("./assets/default.json").then((e=>{U=e.cookingtime,Z=e.experience}))}));const I=c.useMemo((()=>B(l.type)===O.Other),[l.type]);return c.createElement("div",null,c.createElement(V,{showCount:e,data:l,onClick:function(e,n){R((()=>void 0===n?1:1/0)),o((()=>n)),j((()=>e)),t((()=>void 0===n&&B(z.getProps("type"))!==O.Other)),a((()=>!0))},onClear:function(e,t){if(void 0===t)z.setProps({result:{item:void 0,count:0}});else{const e=z.getProps("ingredients");e[t]={item:[]},z.setProps({ingredients:e})}H()}}),c.createElement(F,{limit:_,showCount:e,value:A,visible:n,onCancel:()=>a(!1),onOk:function(e){if(void 0===r)z.setProps({result:{item:e.id[0],count:e.count}});else{r||function(e){const t=z.getProps("type");["blasting","smoking","smelting","campfire_cooking"].includes(t)&&z.setProps({cookingtime:U[t]}),z.setProps({experience:Z[e.id[0]]})}(e);const t=z.getProps("ingredients");t[r]={item:e.id},z.setProps({ingredients:t})}H()}}),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:8,lineHeight:"30px"}},c.createElement("span",null,"type"),c.createElement(C,{title:"配方类型"},c.createElement(k,{style:{color:"#aaa",paddingLeft:4,verticalAlign:"middle"}}))),c.createElement(h,{span:16},c.createElement(f,{style:{width:"100%"},onChange:function(e){z.setProps({type:e}),t((()=>B(z.getProps("type"))!==O.Other)),H()},value:l.type,defaultValue:"crafting_shaped",placeholder:"请选择"},Object.keys(N).map((e=>{const t=N[e].name;return c.createElement(f.Option,{key:e,value:e},t," - ",e)}))))),c.createElement(g,{style:{marginBottom:`${I?"16px":0}`}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:8,lineHeight:"30px"}},c.createElement("span",null,"group"),c.createElement(C,{title:"分组标识"},c.createElement(k,{style:{color:"#aaa",paddingLeft:4,verticalAlign:"middle"}}))),c.createElement(h,{span:16},c.createElement(x,{allowClear:!0,value:l.group,onChange:function(e){z.setProps({group:e.target.value}),H()},placeholder:"选填，相同标识符的配方会在配方书中被显示为一组"}))),I?c.createElement(c.Fragment,null,c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:8,lineHeight:"30px"}},c.createElement("span",null,"cookingtime"),c.createElement(C,{title:"烧炼时间，单位tick，20tick=1s"},c.createElement(k,{style:{color:"#aaa",paddingLeft:4,verticalAlign:"middle"}}))),c.createElement(h,{span:16},c.createElement(E,{min:0,step:20,precision:0,value:l.cookingtime,onChange:function(e){z.setProps({cookingtime:e}),H()},style:{width:"100%"},placeholder:"请输入，单位tick"}))),c.createElement(g,null,c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:8,lineHeight:"30px"}},c.createElement("span",null,"experience"),c.createElement(C,{title:"经验值"},c.createElement(k,{style:{color:"#aaa",paddingLeft:4,verticalAlign:"middle"}}))),c.createElement(h,{span:16},c.createElement(E,{min:0,step:.1,value:l.experience,onChange:function(e){z.setProps({experience:e}),H()},style:{width:"100%"},placeholder:"请输入"})))):null,c.createElement(g,null,c.createElement(h,{offset:4,span:16},c.createElement(b,null))),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"导入"),c.createElement(h,{span:16},c.createElement(x.Search,{placeholder:"请输入",enterButton:"解析",value:s,onChange:e=>m(e.target.value),onSearch:function(e){if(e)try{const t=JSON.parse(e);z.import(t),H()}catch(t){""!==e&&(y.warning("解析失败"),console.log(t)),i((()=>W))}else y.warning("请输入数据！")}}))),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"文件名"),c.createElement(h,{span:16},c.createElement(x.Search,{placeholder:"请输入，缺省时复制到剪切板",value:d,onChange:e=>P(e.target.value),onSearch:function(e){const t=JSON.stringify(z.toJson(),null,2);if(e){if(!/^[a-zA-Z\\$_][a-zA-Z\d_]*$/.test(e))return void y.success("请输入合法的文件名");!function(e,t){const n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}(e+".json",t)}else S(t),y.success("已复制到剪切板")},enterButton:"导出"}))),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"操作"),c.createElement(h,{span:16},c.createElement(w,{style:{marginRight:8},onClick:function(){m((()=>"")),P((()=>"")),z.reset(),H()},type:"primary"},"重置"))))}function G(){return c.createElement("div",{className:"App"},c.createElement("h1",null,"MC Recipe Editor",c.createElement("div",{className:"right"},c.createElement("a",{href:"https://github.com/hans000/mc-recipe-editor/issues",target:"_blank"},"问题反馈"))),c.createElement(q,null),c.createElement("div",{className:"footer"},c.createElement("span",null,"by "),c.createElement("a",{href:"https://github.com/hans000/mc-recipe-editor",target:"_blank"},"hans000"),c.createElement("span",{style:{padding:8}},"交流群916625813"),c.createElement(C,{title:c.createElement(c.Fragment,null,c.createElement("img",{width:110,height:160,src:"./assets/wx.jpg"}),c.createElement("img",{width:110,height:160,src:"./assets/al.jpg"}))},c.createElement("a",null,"赞助作者"))))}p.interceptors.response.use((e=>e.data)),P.render(c.createElement(G,null),document.getElementById("root"));
