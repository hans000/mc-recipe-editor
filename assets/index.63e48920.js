var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,o=(e,t)=>{for(var n in t||(t={}))r.call(t,n)&&l(e,n,t[n]);if(a)for(var n of a(t))i.call(t,n)&&l(e,n,t[n]);return e},s=(e,a)=>t(e,n(a));import{R as c,C as u,D as m,a as p,M as d,b as g,c as h,S as f,I as y,d as E,e as v,f as C,g as k,B as x,h as b,T as w,i as S}from"./vendor.88f4f8dc.js";var O,P;function A(e){return e&&"string"==typeof e?e.startsWith("minecraft:")?e.slice(10):e:"error"}function j(e){return"minecraft:"+e}(P=O||(O={}))[P.CraftShaped=0]="CraftShaped",P[P.CraftShapeless=1]="CraftShapeless",P[P.StoneCutting=2]="StoneCutting",P[P.Smithing=3]="Smithing",P[P.Other=4]="Other";const N={crafting_shaped:{name:"有序合成",type:0},crafting_shapeless:{name:"无序合成",type:1},stonecutting:{name:"切石机",type:2},smithing:{name:"锻造台",type:3},blasting:{name:"高炉",type:4},campfire_cooking:{name:"营火",type:4},smelting:{name:"熔炉",type:4},smoking:{name:"烟熏炉",type:4}};function _(e){return"crafting_shapeless"===e?1:"crafting_shaped"===e?0:"stonecutting"===e?2:"smithing"===e?3:4}var B,R=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},H=(e,t,n)=>(R(e,t,"read from private field"),n?n.call(e):t.get(e));function I(e){return{item:(Array.isArray(e)?e:[e]).map(A)}}function M(e){return I(function(e){return(Array.isArray(e)?e:[e]).map((e=>j(A(e.item))))}(e))}const $=class{constructor(){((e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)})(this,B,$.getDefaultValue())}static convertByPattern(e){return e.pattern.join("").split("").reduce(((t,n)=>" "===n?(t.push(void 0),t):(t.push(M(e.key[n])),t)),[])}static getDefaultValue(){return{type:"crafting_shaped",ingredients:[],result:void 0,group:""}}static getKeyPattern(e){const t={},n={};let a=0;const r=[];let i="";for(Array.from({length:9},(()=>"")).forEach(((l,o)=>{const s=e[o];if(s){const e=s.item.join("-"),r=t[e];let l="";void 0===r?(t[e]=a,l=$.Keys[a++],n[l]=s.item.length>1?s.item.map((e=>({item:j(e)}))):{item:j(s.item[0])}):l=$.Keys[r],i+=l}else i+=" ";o%3==2&&(r.push(i),i="")}));r.length;){if(r[r.length-1].trim())break;r.pop()}return{key:n,pattern:r}}get data(){const e=H(this,B),{ingredients:t,result:n}=e,l=((e,t)=>{var n={};for(var l in e)r.call(e,l)&&t.indexOf(l)<0&&(n[l]=e[l]);if(null!=e&&a)for(var l of a(e))t.indexOf(l)<0&&i.call(e,l)&&(n[l]=e[l]);return n})(e,["ingredients","result"]);return s(o({},l),{input:t.map((e=>({id:e.item}))),output:n?{id:n.item?[n.item]:[],count:n.count}:{}})}reset(){var e,t,n,a;e=this,t=B,n=$.getDefaultValue(),R(e,t,"write to private field"),a?a.call(e,n):t.set(e,n)}import(e){this.reset();const{group:t,experience:n,cookingtime:a}=e,r=A(e.type);let i,l,o;i="crafting_shaped"===r?$.convertByPattern(e):"crafting_shapeless"===r?e.ingredients.map((e=>M(e))):"smithing"===r?[I(e.base.item),I(e.addition.item)]:[M(e.ingredient)],"string"==typeof e.result?(l=A(e.result),o=e.count||1):(l=A(e.result.item),o=e.result.count),this.setProps({type:r,group:t,experience:n,cookingtime:a,ingredients:i,result:{item:l,count:o}})}getProps(e){return H(this,B)[e]}setProps(e){Object.keys(e).forEach((t=>{H(this,B)[t]=e[t]}))}toJson(){const{ingredients:e,result:t,cookingtime:n,experience:a,group:r}=H(this,B),i=_(H(this,B).type),l=j(H(this,B).type);if(i===O.CraftShaped){const{pattern:n,key:a}=$.getKeyPattern(e),i={type:l,key:a,pattern:n,result:t};return r?s(o({},i),{group:r}):i}if(i===O.CraftShapeless){const n={type:l,result:t,ingredients:e.map((e=>e.item.map((e=>({item:e})))))};return r?s(o({},n),{group:r}):n}if(i===O.StoneCutting){const n={type:l,count:t.count,result:t.item,ingredient:e.map((e=>({item:e.item[0]})))};return r?s(o({},n),{group:r}):n}if(i===O.Smithing){const[n,a]=e.map((e=>({item:e.item[0]}))),i={type:l,base:n,addition:a,result:{item:null==t?void 0:t.item,count:null==t?void 0:t.count}};return r?s(o({},i),{group:r}):i}const c={type:l,cookingtime:n,experience:a,result:null==t?void 0:t.item,ingredient:e.map((e=>({item:e.item[0]})))};return r?s(o({},c),{group:r}):c}};let D=$;B=new WeakMap,D.Keys=["#","$","*","%","&","|","!","+","-"];function K(e){var t,n,a,r;const i=c.useMemo((()=>{var t,n;return(null==(n=null==(t=null==e?void 0:e.data)?void 0:t.id)?void 0:n.length)?e.data.id:[]}),[e.data]);const l=c.useMemo((()=>i.length?(e.offset+1)%i.length:0),[e.offset]);return c.createElement("div",{className:"tile",onClick:null==(t=null==e?void 0:e.onClick)?void 0:t.bind(null,e.data)},c.createElement("i",{style:{display:"inline-block"},className:`icon-${i[l]}`},e.showCount&&(null==(n=e.data)?void 0:n.count)?c.createElement("span",null,e.data.count):null,(null==(r=null==(a=e.data)?void 0:a.id)?void 0:r.length)?c.createElement(u,{onClick:function(t){t.stopPropagation(),null==e||e.onClear(e.data)},className:"close"}):null))}function T(e){return c.createElement("div",{className:"grid",style:{width:42*e.cols}},Array.from({length:e.cols*e.rows}).map(((t,n)=>{const a=e.data[n];return c.createElement(K,{key:n,data:a,offset:e.offset,onClear:e.onClear&&e.onClear.bind(null,a,n),onClick:e.onClick&&e.onClick.bind(null,a,n)})})))}function J(e){return c.createElement("div",{className:"smithing"},c.createElement(K,{offset:e.offset,data:e.data[0],onClick:e.onClick&&e.onClick.bind(null,e.data[0],0)}),c.createElement("div",{className:"smithing-add"}),c.createElement(K,{offset:e.offset,data:e.data[1],onClick:e.onClick&&e.onClick.bind(null,e.data[1],1)}))}function V(e){const[t,n]=m.exports.useState(0);return m.exports.useEffect((()=>{let e;return e=window.setInterval((()=>{n((e=>e+1))}),1e3),()=>clearInterval(e)}),[]),c.createElement("div",{className:"craft"},c.createElement("div",{className:"input"},"crafting_shaped"===e.data.type||"crafting_shapeless"===e.data.type?c.createElement(T,{rows:3,cols:3,offset:t,data:e.data.input,onClick:e.onClick,onClear:e.onClear}):"smithing"===e.data.type?c.createElement(J,{offset:t,data:e.data.input,onClear:e.onClear,onClick:e.onClick}):c.createElement(K,{offset:t,data:e.data.input[0],onClear:e.onClear&&e.onClear.bind(null,e.data.input[0],0),onClick:e.onClick&&e.onClick.bind(null,e.data.input[0],0)})),c.createElement("div",{className:"arrow"}),c.createElement("div",{className:"output"},c.createElement(K,{data:e.data.output,showCount:e.showCount,offset:t,onClear:e.onClear&&e.onClear.bind(null,e.data.output,void 0),onClick:e.onClick&&e.onClick.bind(null,e.data.output,void 0)})))}function F(e){const[t,n]=m.exports.useState(1),[a,r]=m.exports.useState([]),[i,l]=m.exports.useState([]);function o(e){r((t=>{const[n]=e.id,a=[...t];return a.splice(t.findIndex((e=>e===n)),1),a}))}return m.exports.useEffect((()=>{p.get("./assets/map.json").then((e=>{const t=Object.entries(e).map((([e,t])=>({id:e,name:t})));l((()=>t))}))}),[]),m.exports.useEffect((()=>{r((()=>{var t;return(null==(t=e.value)?void 0:t.id)||[]})),n((()=>{var t;return(null==(t=e.value)?void 0:t.count)||1}))}),[e.visible]),c.createElement(d,{className:"item-modal",okText:"确定",cancelText:"取消",title:"物品选择框",maskClosable:!1,width:690,onOk:function(){null==e||e.onOk({id:a,count:t}),null==e||e.onCancel()},onCancel:e.onCancel,visible:e.visible},c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:20,lineHeight:"30px"}},"物品"),c.createElement(h,{span:17},c.createElement(f,{showSearch:!0,allowClear:!0,mode:"multiple",value:a,tagRender:function(e){return c.createElement(K,{offset:0,onClear:o,data:{id:[e.value]}})},onChange:function(t){t.length>e.limit?E.warning(`仅能选择 ${e.limit} 项`):r((()=>t))},style:{width:"100%"},filterOption:(e,{name:t,value:n})=>(n+t).includes(e),notFoundContent:"暂无内容",placeholder:"请选择，可搜索"},i.map((({id:e,name:t})=>c.createElement(f.Option,{key:e,value:e,name:t},t," - ",e)))))),e.showCount?c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:20,lineHeight:"30px"}},"数量"),c.createElement(h,{span:17},c.createElement(y,{step:1,max:64,min:1,style:{width:"100%"},value:t,onChange:e=>n((()=>e))}))):null)}p.interceptors.response.use((e=>e.data));const W={type:"crafting_shaped",input:[],output:{}};let z=new D;function Z(){const[e,t]=m.exports.useState(!0),[n,a]=m.exports.useState(!1),[r,i]=m.exports.useState(W),[l,o]=m.exports.useState(0),[s,u]=m.exports.useState(""),[p,d]=m.exports.useState(""),[w,S]=m.exports.useState(),[P,A]=m.exports.useState(-1);function j(){i((()=>z.data)),S((()=>{})),o((()=>0))}m.exports.useEffect((()=>{"1.0.0"!==localStorage.getItem("version")&&(v.open({duration:0,message:c.createElement("div",null,c.createElement("h3",null,"1.0.0-beta版本"),c.createElement("div",null,"支持常见8种类型配方的定义"),c.createElement("div",null,"支持展示数组类型的配方"),c.createElement("div",null,"支持下载文件与复制到剪贴板"),c.createElement("div",{style:{textAlign:"right"}},"感谢您的支持 by hans000"))}),localStorage.setItem("version","1.0.0"))}),[]);const B=c.useMemo((()=>_(r.type)===O.Other),[r.type]);return c.createElement("div",null,c.createElement(V,{showCount:e,data:r,onClick:function(e,n){A((()=>void 0===n?1:1/0)),o((()=>n)),S((()=>e)),t((()=>void 0===n&&_(z.getProps("type"))!==O.Other)),a((()=>!0))},onClear:function(e,t){if(void 0===t)z.setProps({result:{item:void 0,count:0}});else{const e=z.getProps("ingredients");e[t]={item:[]},z.setProps({ingredients:e})}j()}}),c.createElement(F,{limit:P,showCount:e,value:w,visible:n,onCancel:()=>a(!1),onOk:function(e){if(void 0===l)z.setProps({result:{item:e.id[0],count:e.count}});else{const t=z.getProps("ingredients");t[l]={item:e.id},z.setProps({ingredients:t})}j()}}),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"type"),c.createElement(h,{span:16},c.createElement(f,{style:{width:"100%"},onChange:function(e){z.setProps({type:e}),t((()=>_(z.getProps("type"))!==O.Other)),j()},value:r.type,defaultValue:"crafting_shaped",placeholder:"请选择"},Object.keys(N).map((e=>{const t=N[e].name;return c.createElement(f.Option,{key:e,value:e},t," - ",e)}))))),c.createElement(g,{style:{marginBottom:`${B?"16px":0}`}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"group"),c.createElement(h,{span:16},c.createElement(C,{allowClear:!0,value:r.group,onChange:function(e){z.setProps({group:e.target.value}),j()},placeholder:"分组，选填"}))),B?c.createElement(c.Fragment,null,c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"cookingtime"),c.createElement(h,{span:16},c.createElement(y,{min:0,value:r.cookingtime,onChange:function(e){z.setProps({cookingtime:e}),j()},style:{width:"100%"},placeholder:"请输入"}))),c.createElement(g,null,c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"experience"),c.createElement(h,{span:16},c.createElement(y,{min:0,value:r.experience,onChange:function(e){z.setProps({experience:e}),j()},style:{width:"100%"},placeholder:"请输入"})))):null,c.createElement(g,null,c.createElement(h,{offset:4,span:16},c.createElement(k,null))),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"导入"),c.createElement(h,{span:16},c.createElement(C.Search,{placeholder:"请输入",enterButton:"解析",value:s,onChange:e=>u(e.target.value),onSearch:function(e){if(e)try{const t=JSON.parse(e);z.import(t),j()}catch(t){""!==e&&(E.warning("解析失败"),console.log(t)),i((()=>W))}else E.warning("请输入数据！")}}))),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"文件名"),c.createElement(h,{span:16},c.createElement(C.Search,{placeholder:"请输入，缺省时复制到剪切板",value:p,onChange:e=>d(e.target.value),onSearch:function(e){const t=JSON.stringify(z.toJson(),null,2);if(e){if(!/^[a-zA-Z\\$_][a-zA-Z\d_]*$/.test(e))return void E.success("请输入合法的文件名");!function(e,t){const n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}(e+".json",t)}else b(t),E.success("已复制到剪切板")},enterButton:"导出"}))),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"操作"),c.createElement(h,{span:16},c.createElement(x,{style:{marginRight:8},onClick:function(){u((()=>"")),d((()=>"")),z.reset(),j()},type:"primary"},"重置"))))}function U(){return c.createElement("div",{className:"App"},c.createElement("h1",null,"MC Recipe Editor",c.createElement("div",{className:"right"},c.createElement("a",{href:"https://github.com/hans000/mc-recipe-editor/issues",target:"_blank"},"问题反馈"))),c.createElement(Z,null),c.createElement("div",{className:"footer"},c.createElement("span",null,"by "),c.createElement("a",{href:"https://github.com/hans000/mc-recipe-editor",target:"_blank"},"hans000"),c.createElement("span",{style:{padding:8}},"交流群916625813"),c.createElement(w,{title:c.createElement(c.Fragment,null,c.createElement("img",{width:110,height:160,src:"./assets/wx.jpg"}),c.createElement("img",{width:110,height:160,src:"./assets/al.jpg"}))},c.createElement("a",null,"赞助作者"))))}S.render(c.createElement(U,null),document.getElementById("root"));
