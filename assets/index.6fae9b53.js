var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,o=(e,t)=>{for(var n in t||(t={}))l.call(t,n)&&i(e,n,t[n]);if(a)for(var n of a(t))r.call(t,n)&&i(e,n,t[n]);return e},s=(e,a)=>t(e,n(a));import{R as c,C as u,D as m,a as p,M as d,b as g,c as h,S as f,I as E,d as y,e as v,j as C,T as k,f as x,g as b,h as w,B as S,i as O,k as P}from"./vendor.4ad4dcc1.js";var A,j;function _(e){return e&&"string"==typeof e?e.startsWith("minecraft:")?e.slice(10):e:"error"}function N(e){return"minecraft:"+e}(j=A||(A={}))[j.CraftShaped=0]="CraftShaped",j[j.CraftShapeless=1]="CraftShapeless",j[j.StoneCutting=2]="StoneCutting",j[j.Smithing=3]="Smithing",j[j.Other=4]="Other";const R={crafting_shaped:{name:"有序合成",type:0},crafting_shapeless:{name:"无序合成",type:1},stonecutting:{name:"切石机",type:2},smithing:{name:"锻造台",type:3},blasting:{name:"高炉",type:4},campfire_cooking:{name:"营火",type:4},smelting:{name:"熔炉",type:4},smoking:{name:"烟熏炉",type:4}};function B(e){return"crafting_shapeless"===e?1:"crafting_shaped"===e?0:"stonecutting"===e?2:"smithing"===e?3:4}var H,I=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},M=(e,t,n)=>(I(e,t,"read from private field"),n?n.call(e):t.get(e));function T(e){return{item:(Array.isArray(e)?e:[e]).map(_)}}function $(e){return T(function(e){return(Array.isArray(e)?e:[e]).map((e=>N(_(e.item))))}(e))}const D=class{constructor(){((e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)})(this,H,D.getDefaultValue())}static convertByPattern(e){return e.pattern.join("").split("").reduce(((t,n)=>" "===n?(t.push(void 0),t):(t.push($(e.key[n])),t)),[])}static getDefaultValue(){return{type:"crafting_shaped",ingredients:[],result:void 0,group:""}}static getKeyPattern(e){const t={},n={};let a=0;const l=[];let r="";for(Array.from({length:9},(()=>"")).forEach(((i,o)=>{const s=e[o];if(s){const e=s.item.join("-"),l=t[e];let i="";void 0===l?(t[e]=a,i=D.Keys[a++],n[i]=s.item.length>1?s.item.map((e=>({item:N(e)}))):{item:N(s.item[0])}):i=D.Keys[l],r+=i}else r+=" ";o%3==2&&(l.push(r),r="")}));l.length;){if(l[l.length-1].trim())break;l.pop()}return{key:n,pattern:l}}get data(){const e=M(this,H),{ingredients:t,result:n}=e,i=((e,t)=>{var n={};for(var i in e)l.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&a)for(var i of a(e))t.indexOf(i)<0&&r.call(e,i)&&(n[i]=e[i]);return n})(e,["ingredients","result"]);return s(o({},i),{input:t.map((e=>e?{id:e.item}:void 0)),output:n?{id:n.item?[n.item]:[],count:n.count}:{}})}reset(){var e,t,n,a;e=this,t=H,n=D.getDefaultValue(),I(e,t,"write to private field"),a?a.call(e,n):t.set(e,n)}import(e){this.reset();const{group:t,experience:n,cookingtime:a}=e,l=_(e.type);let r,i,o;r="crafting_shaped"===l?D.convertByPattern(e):"crafting_shapeless"===l?e.ingredients.map((e=>$(e))):"smithing"===l?[T(e.base.item),T(e.addition.item)]:[$(e.ingredient)],"string"==typeof e.result?(i=_(e.result),o=e.count||1):(i=_(e.result.item),o=e.result.count),this.setProps({type:l,group:t,experience:n,cookingtime:a,ingredients:r,result:{item:i,count:o}})}getProps(e){return M(this,H)[e]}setProps(e){Object.keys(e).forEach((t=>{M(this,H)[t]=e[t]}))}toJson(){const{ingredients:e,result:t,cookingtime:n,experience:a,group:l}=M(this,H),r=B(M(this,H).type),i=N(M(this,H).type);if(r===A.CraftShaped){const{pattern:n,key:a}=D.getKeyPattern(e),r={type:i,key:a,pattern:n,result:t};return l?s(o({},r),{group:l}):r}if(r===A.CraftShapeless){const n={type:i,result:t,ingredients:e.map((e=>e.item.map((e=>({item:e})))))};return l?s(o({},n),{group:l}):n}if(r===A.StoneCutting){const n={type:i,count:t.count,result:t.item,ingredient:e.map((e=>({item:e.item[0]})))};return l?s(o({},n),{group:l}):n}if(r===A.Smithing){const[n,a]=e.map((e=>({item:e.item[0]}))),r={type:i,base:n,addition:a,result:{item:null==t?void 0:t.item,count:null==t?void 0:t.count}};return l?s(o({},r),{group:l}):r}const c={type:i,cookingtime:n,experience:a,result:null==t?void 0:t.item,ingredient:e.map((e=>({item:e.item[0]})))};return l?s(o({},c),{group:l}):c}};let K=D;H=new WeakMap,K.Keys=["#","$","*","%","&","|","!","+","-"];function J(e){var t,n,a,l;const r=c.useMemo((()=>{var t,n;return(null==(n=null==(t=null==e?void 0:e.data)?void 0:t.id)?void 0:n.length)?e.data.id:[]}),[e.data]);const i=c.useMemo((()=>r.length?(e.offset+1)%r.length:0),[e.offset]);return c.createElement("div",{className:"tile",onClick:null==(t=null==e?void 0:e.onClick)?void 0:t.bind(null,e.data)},c.createElement("i",{title:r[i],style:{display:"inline-block"},className:`icon-${r[i]}`},e.showCount&&(null==(n=e.data)?void 0:n.count)?c.createElement("span",null,e.data.count):null,(null==(l=null==(a=e.data)?void 0:a.id)?void 0:l.length)?c.createElement(u,{onClick:function(t){t.stopPropagation(),null==e||e.onClear(e.data)},className:"close"}):null))}function L(e){return c.createElement("div",{className:"grid",style:{width:42*e.cols}},Array.from({length:e.cols*e.rows}).map(((t,n)=>{const a=e.data[n];return c.createElement(J,{key:n,data:a,offset:e.offset,onClear:e.onClear&&e.onClear.bind(null,a,n),onClick:e.onClick&&e.onClick.bind(null,a,n)})})))}function V(e){return c.createElement("div",{className:"smithing"},c.createElement(J,{offset:e.offset,data:e.data[0],onClick:e.onClick&&e.onClick.bind(null,e.data[0],0)}),c.createElement("div",{className:"smithing-add"}),c.createElement(J,{offset:e.offset,data:e.data[1],onClick:e.onClick&&e.onClick.bind(null,e.data[1],1)}))}function z(e){const[t,n]=m.exports.useState(0);return m.exports.useEffect((()=>{let e;return e=window.setInterval((()=>{n((e=>e+1))}),1e3),()=>clearInterval(e)}),[]),c.createElement("div",{className:"craft"},c.createElement("div",{className:"input"},"crafting_shaped"===e.data.type||"crafting_shapeless"===e.data.type?c.createElement(L,{rows:3,cols:3,offset:t,data:e.data.input,onClick:e.onClick,onClear:e.onClear}):"smithing"===e.data.type?c.createElement(V,{offset:t,data:e.data.input,onClear:e.onClear,onClick:e.onClick}):c.createElement(J,{offset:t,data:e.data.input[0],onClear:e.onClear&&e.onClear.bind(null,e.data.input[0],0),onClick:e.onClick&&e.onClick.bind(null,e.data.input[0],0)})),c.createElement("div",{className:"arrow"}),c.createElement("div",{className:"output"},c.createElement(J,{data:e.data.output,showCount:e.showCount,offset:t,onClear:e.onClear&&e.onClear.bind(null,e.data.output,void 0),onClick:e.onClick&&e.onClick.bind(null,e.data.output,void 0)})))}function F(e){const[t,n]=m.exports.useState(1),[a,l]=m.exports.useState([]),[r,i]=m.exports.useState([]);function o(e){l((t=>{const[n]=e.id,a=[...t];return a.splice(t.findIndex((e=>e===n)),1),a}))}return m.exports.useEffect((()=>{p.get("./assets/map.json").then((e=>{const t=Object.entries(e).map((([e,t])=>({id:e,name:t})));i((()=>t))}))}),[]),m.exports.useEffect((()=>{l((()=>{var t;return(null==(t=e.value)?void 0:t.id)||[]})),n((()=>{var t;return(null==(t=e.value)?void 0:t.count)||1}))}),[e.visible]),c.createElement(d,{className:"item-modal",okText:"确定",cancelText:"取消",title:"物品选择框",maskClosable:!1,width:690,onOk:function(){null==e||e.onOk({id:a,count:t}),null==e||e.onCancel()},onCancel:e.onCancel,visible:e.visible},c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:20,lineHeight:"30px"}},"物品"),c.createElement(h,{span:17},c.createElement(f,{showSearch:!0,allowClear:!0,mode:"multiple",value:a,tagRender:function(e){return c.createElement(J,{offset:0,onClear:o,data:{id:[e.value]}})},onChange:function(t){t.length>e.limit?y.warning(`仅能选择 ${e.limit} 项`):l((()=>t))},style:{width:"100%"},filterOption:(e,{name:t,value:n})=>(n+t).includes(e),notFoundContent:"暂无内容",placeholder:"请选择，可搜索"},r.map((({id:e,name:t})=>c.createElement(f.Option,{key:e,value:e,name:t},t," - ",e)))))),e.showCount?c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:20,lineHeight:"30px"}},"数量"),c.createElement(h,{span:17},c.createElement(E,{step:1,max:64,min:1,style:{width:"100%"},value:t,onChange:e=>n((()=>e))}))):null)}const W={type:"crafting_shaped",input:[],output:{}};let Z=new K;let G={},U={};function q(){const[e,t]=m.exports.useState(!0),[n,a]=m.exports.useState(!1),[l,r]=m.exports.useState(W),[i,o]=m.exports.useState(0),[s,u]=m.exports.useState(""),[d,P]=m.exports.useState(""),[j,_]=m.exports.useState(),[N,H]=m.exports.useState(-1),[I,M]=m.exports.useState(1),[T,$]=m.exports.useState([]),D=m.exports.useRef(null);function K(e){if(e)try{const t=JSON.parse(e);Z.import(t),J()}catch(t){""!==e&&(y.warning("解析失败"),console.log(t)),r((()=>W))}else y.warning("请输入数据！")}function J(){r((()=>Z.data)),_((()=>{})),o((()=>0))}m.exports.useEffect((()=>{"1.2.0"!==localStorage.getItem("version")&&(v.open({duration:0,message:c.createElement("div",null,c.createElement("h3",null,"v","1.2.0"),c.createElement("div",null,"支持常见8种类型配方的定义"),c.createElement("div",null,"支持展示数组类型的配方"),c.createElement("div",null,"支持下载文件与复制到剪贴板"),c.createElement("div",null,"支持部分经验值和烧制时间默认值填充"),c.createElement("div",{style:{color:"orange"}},"导入功能添加对原版配方的支持"),c.createElement("div",{style:{textAlign:"right"}},"感谢您的支持 by hans000"))}),localStorage.setItem("version","1.2.0"))}),[]),m.exports.useEffect((()=>{p.get("./assets/default.json").then((e=>{U=e.cookingtime,G=e.experience})),p.get("./assets/recipe.zip",{responseType:"arraybuffer"}).then((e=>{C.loadAsync(e).then((e=>{$((()=>Object.keys(e.files).map((e=>e.split(".")[0])))),D.current=e}))}))}),[]);const L=c.useMemo((()=>B(l.type)===A.Other),[l.type]);return c.createElement("div",null,c.createElement(z,{showCount:e,data:l,onClick:function(e,n){H((()=>void 0===n?1:1/0)),o((()=>n)),_((()=>e)),t((()=>void 0===n&&B(Z.getProps("type"))!==A.Other)),a((()=>!0))},onClear:function(e,t){if(void 0===t)Z.setProps({result:{item:void 0,count:0}});else{const e=Z.getProps("ingredients");e[t]={item:[]},Z.setProps({ingredients:e})}J()}}),c.createElement(F,{limit:N,showCount:e,value:j,visible:n,onCancel:()=>a(!1),onOk:function(e){if(void 0===i)Z.setProps({result:{item:e.id[0],count:e.count}});else{i||function(e){const t=Z.getProps("type");["blasting","smoking","smelting","campfire_cooking"].includes(t)&&Z.setProps({cookingtime:U[t]}),Z.setProps({experience:G[e.id[0]]})}(e);const t=Z.getProps("ingredients");t[i]={item:e.id},Z.setProps({ingredients:t})}J()}}),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:8,lineHeight:"30px"}},c.createElement("span",null,"type"),c.createElement(k,{title:"配方类型"},c.createElement(x,{style:{color:"#aaa",paddingLeft:4,verticalAlign:"middle"}}))),c.createElement(h,{span:16},c.createElement(f,{style:{width:"100%"},onChange:function(e){Z.setProps({type:e}),t((()=>B(Z.getProps("type"))!==A.Other)),J()},value:l.type,defaultValue:"crafting_shaped",placeholder:"请选择"},Object.keys(R).map((e=>{const t=R[e].name;return c.createElement(f.Option,{key:e,value:e},t," - ",e)}))))),c.createElement(g,{style:{marginBottom:`${L?"16px":0}`}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:8,lineHeight:"30px"}},c.createElement("span",null,"group"),c.createElement(k,{title:"分组标识"},c.createElement(x,{style:{color:"#aaa",paddingLeft:4,verticalAlign:"middle"}}))),c.createElement(h,{span:16},c.createElement(b,{allowClear:!0,value:l.group,onChange:function(e){Z.setProps({group:e.target.value}),J()},placeholder:"选填，相同标识符的配方会在配方书中被显示为一组"}))),L?c.createElement(c.Fragment,null,c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:8,lineHeight:"30px"}},c.createElement("span",null,"cookingtime"),c.createElement(k,{title:"烧炼时间，单位tick，20tick=1s"},c.createElement(x,{style:{color:"#aaa",paddingLeft:4,verticalAlign:"middle"}}))),c.createElement(h,{span:16},c.createElement(E,{min:0,step:20,precision:0,value:l.cookingtime,onChange:function(e){Z.setProps({cookingtime:e}),J()},style:{width:"100%"},placeholder:"请输入，单位tick"}))),c.createElement(g,null,c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:8,lineHeight:"30px"}},c.createElement("span",null,"experience"),c.createElement(k,{title:"经验值"},c.createElement(x,{style:{color:"#aaa",paddingLeft:4,verticalAlign:"middle"}}))),c.createElement(h,{span:16},c.createElement(E,{min:0,step:.1,value:l.experience,onChange:function(e){Z.setProps({experience:e}),J()},style:{width:"100%"},placeholder:"请输入"})))):null,c.createElement(g,null,c.createElement(h,{offset:4,span:16},c.createElement(w,null))),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"导入"),c.createElement(h,{span:16},c.createElement(b.Group,{compact:!0},c.createElement(f,{value:I,onChange:e=>M(e),style:{width:"25%"}},c.createElement(f.Option,{value:1},"原版配方"),c.createElement(f.Option,{value:2},"自定义配方")),1===I?c.createElement(f,{showSearch:!0,style:{width:"75%"},onChange:function(e){D.current.file(e+".json").async("string").then((e=>{u(e),K(e)}))}},T.map((e=>c.createElement(f.Option,{key:e,value:e},e)))):c.createElement(b.Search,{style:{width:"75%"},placeholder:"请输入",enterButton:"解析",value:s,onChange:e=>u(e.target.value),onSearch:K})))),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"文件名"),c.createElement(h,{span:16},c.createElement(b.Search,{placeholder:"请输入，缺省时复制到剪切板",value:d,onChange:e=>P(e.target.value),onSearch:function(e){const t=JSON.stringify(Z.toJson(),null,2);if(e){if(!/^[a-zA-Z\\$_][a-zA-Z\d_]*$/.test(e))return void y.success("请输入合法的文件名");!function(e,t){const n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}(e+".json",t)}else O(t),y.success("已复制到剪切板")},enterButton:"导出"}))),c.createElement(g,{style:{marginBottom:16}},c.createElement(h,{span:4,style:{textAlign:"right",paddingRight:16,lineHeight:"30px"}},"操作"),c.createElement(h,{span:16},c.createElement(S,{style:{marginRight:8},onClick:function(){u((()=>"")),P((()=>"")),Z.reset(),J()},type:"primary"},"重置"))))}function Q(){return c.createElement("div",{className:"App"},c.createElement("h1",null,"MC Recipe Editor",c.createElement("div",{className:"right"},c.createElement("a",{href:"https://github.com/hans000/mc-recipe-editor/issues",target:"_blank"},"问题反馈"))),c.createElement(q,null),c.createElement("div",{className:"footer"},c.createElement("span",null,"by "),c.createElement("a",{href:"https://github.com/hans000/mc-recipe-editor",target:"_blank"},"hans000"),c.createElement("span",{style:{padding:8}},"交流群916625813"),c.createElement(k,{title:c.createElement(c.Fragment,null,c.createElement("img",{width:110,height:160,src:"./assets/wx.jpg"}),c.createElement("img",{width:110,height:160,src:"./assets/al.jpg"}))},c.createElement("a",null,"赞助作者"))))}p.interceptors.response.use((e=>e.data)),P.render(c.createElement(Q,null),document.getElementById("root"));
